<!DOCTYPE html SYSTEM "about:legacy-compat">
<html>
      <head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <title>the-bson — Building DBObjects</title>
        
        <link rel="stylesheet" href="css/blueprint/screen.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/blueprint/grid.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <link rel="stylesheet" href="css/blueprint/print.css" type="text/css" media="print"/> 
        <!--[if lt IE 8]>
          <link rel="stylesheet" href={ relativeBase + "css/blueprint/ie.css" } type="text/css" media="screen, projection"/>
        <![endif]-->
        <link rel="stylesheet" href="css/pamflet.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/pamflet-print.css" type="text/css" media="print"/>
        <link rel="stylesheet" href="css/pamflet-grid.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <link rel="stylesheet" href="css/color_scheme-redmond.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/color_scheme-github.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/color_scheme-monokai.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/pamfletheight_2em_2em.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <script type="text/javascript" src="js/jquery-1.6.2.min.js"></script>
        <script type="text/javascript" src="js/jquery.collapse.js"></script>
        <script type="text/javascript" src="js/pamflet.js"></script>
        <script type="text/javascript">
          Pamflet.page.language = 'en';
        </script>
        <script type="text/javascript" src="js/prettify/prettify.js"></script><script type="text/javascript" src="js/prettify/lang-scala.js"></script><link type="text/css" rel="stylesheet" href="css/prettify.css"/><script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
        
        
        
      </head>
      <body class="color_scheme-redmond">
        <a class="page prev nav" href="Field+encoding.html">
            <span class="space">&nbsp;</span>
            <span class="flip arrow">❧</span>
          </a><a class="page next nav" href="Encoding.html">
            <span class="space">&nbsp;</span>
            <span class="arrow">❧</span>
          </a>
        <div class="container contentswrapper">
          <div class="span-16 prepend-1 append-1 contents">
            <h4 id="Building+DBObjects">Building DBObjects<a href="#Building+DBObjects" class="header-link"><span class="header-link-content">&nbsp;</span></a></h4><p>this library provides several methods for building DBObject from key-value pairs in the <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.Builders">Builders</a> trait.
these methods rely on having <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.EncodeBsonField">EncodeBsonField</a> instances available for the value types.
</p><p>the two important items provided are <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.Builders$DBO">DBOKV</a> and <a href="/latest/api/#io.github.raptros.bson.Builders$StringToDBOKV">StringToDBOKV</a>:
</p><pre><code class="prettyprint lang-scala">val dbo = new BasicDBObject() //from the mongo-java-driver
val kv = &quot;keyname&quot; :&gt; 25 //produces DBOKV[Int](&quot;keyname&quot;, 25)
kv.write(dbo) //writes 25 into db at the key &quot;keyname&quot;
</code></pre><p>note that <code>:&gt;</code> only produces a <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.Builders$DBO">DBOKV</a> if an implicit <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.EncodeBsonField">EncodeBsonField</a> can be found for the type of the argument.
</p><p>there are two different ways to write optional values.
</p><ul><li><p>the first way relies on the instance for <code>EncodeBsonField[Option[A]]</code> in <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.EncodeBsonFields">EncodeBsonFields</a>
</p><pre><code class="prettyprint lang-scala">// produces DBOKV[Option[Int]](&quot;keyname1&quot;, Some(25))
val kv1 = &quot;keyname1&quot; :&gt; Some(25)
// produces DBOKV[Option[Int]](&quot;keyname2&quot;, None)
val kv2 = &quot;keyname2&quot; :&gt; (None: Option[Int])
//if you write them ...
val dbo = new BasicDBObject() //from the mongo-java-driver
kv1.write(dbo) //writes 25 into dbo at key &quot;keyname1&quot;
kv2.write(dbo) //does not write into dbo
</code></pre></li><li><p>the second uses a method in <a href="/latest/api/#io.github.raptros.bson.Builders$StringToDBOKV">StringToDBOKV</a> and uses the encoder for A directly:
</p><pre><code class="prettyprint lang-scala">//produces Some(DBOKV[Int](&quot;keyname1&quot;, 25))
val kv1 = &quot;keyname1&quot; :?&gt; Some(25)
// produces None
val kv2 = &quot;keyname2&quot; :?&gt; None
</code></pre><p>the utility of this method will be explained later
</p></li></ul><p>there are two ways to use these <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.Builders$DBO">DBOKV</a>s:
</p><ul><li><p>you can use the <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.Builders$DBO$">DBO</a> object and the apply method it contains:
</p><pre><code class="prettyprint lang-scala">val dbo = DBO(
    &quot;key1&quot; :&gt; 33,
    &quot;key2&quot; :&gt; &quot;another value&quot;,
    &quot;booleanKey&quot; :&gt; true)
</code></pre></li><li><p>you can use the methods provided by <a href="http://raptros.github.io/the-bson/latest/api/#io.github.raptros.bson.Builders$DBOBuilder">DBOBuilder</a>, an implicit class which wraps around DBObjects:
</p><pre><code class="prettyprint lang-scala">//this just creates a new DBObject
val dbo = DBO.empty 
//the method +@+ writes the DBOKV into dbo and then returns dbo;
//this permits chaining
dbo +@+ (&quot;key1&quot; :&gt; 33) 
dbo +@+ (&quot;bool1&quot; :&gt; true) +@+ (&quot;bool2&quot; :&gt; false)
//you can also append a sequenece of keys using the ++@++ method
dbo ++@++ Seq(&quot;k3&quot; :&gt; &quot;a string&quot;, &quot;k4&quot; :&gt; 3.14)
//there is a method +?+ which takes an Optional[DBOKV],
//writes it it is Some, and returns the dbo either way
dbo +?+ (&quot;optionWritten&quot; :?&gt; Some(55)) +?+ 
    (&quot;optionNotWritten&quot; :?&gt; None) +@+ 
    (&quot;alwaysWritten&quot; :&gt; true)
//finally, there is a Unitary write method.
dbo.write(&quot;datetime&quot;, DateTime.now()) //using the joda-time DateTime
</code></pre><p>note that all of these methods mutate dbo! this means they should be used with caution.
in fact, it might be best not to allow DBOBjects to leak out of the scope they are instantiated in.
</p></li></ul><div class="bottom nav span-16">
                        <em>Next Page</em>
                        <span class="arrow">❧</span>
                        <a href="Encoding.html"> Encoding </a>                        
                        
                      </div><div class="tocwrapper show">
      <a class="tochead nav" style="display: none" href="#toc">❦</a>
      <a name="toc"></a>
      <h4 class="toctitle">Contents</h4>
      <div class="tocbody">
      <div><a href="the-bson.html">the-bson</a></div><ol class="toc"> <li><div><a href="Installation.html">Installation</a></div></li><li><div><a href="How+to+use.html">How to use</a></div><ol class="toc"> <li><div><a href="Making+DBOs.html">Making DBOs</a></div><ol class="toc"> <li><div><a href="Field+encoding.html">Field encoding</a></div></li><li><div class="current">Building DBObjects</div></li><li><div><a href="Encoding.html">Encoding</a></div></li> </ol></li><li><div><a href="Decoding+DBObjects.html">Decoding DBObjects</a></div><ol class="toc"> <li><div><a href="Decoding+Fields.html">Decoding Fields</a></div></li><li><div><a href="Decoding+objects.html">Decoding objects</a></div></li> </ol></li><li><div><a href="Codecs.html">Codecs</a></div></li><li><div><a href="Macros.html">Macros</a></div></li> </ol></li><li class="generated"><div><a href="Contents+in+Depth.html">Contents in Depth</a></div></li><li class="generated"><div><a href="Combined+Pages.html">Combined Pages</a></div></li> </ol></div></div>
          </div>
        </div>
        <div class="header">
          <div class="container">
        <div class="span-16 prepend-1 append-1">
          <div class="span-16 top nav">
            <div class="span-16 title">
              <span>the-bson</span> — Building DBObjects
            </div>
          </div>
        </div>
      </div>
        </div>
        <div class="footer">
          
        </div>
        
        
      </body>
    </html>